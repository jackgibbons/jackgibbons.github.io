/*!CK:1321380055!*//*1387292963,178186555*/

if (self.CavalryLogger) { CavalryLogger.start_js(["0q732"]); }

__d("ComposerXHiddenInputClear",[],function(a,b,c,d,e,f){function g(h){h.element.value='';}e.exports=g;});
__d("ComposerXSessionInputClear",[],function(a,b,c,d,e,f){function g(h){h.element.value=(new Date()).valueOf().toString().substr(0,10);}e.exports=g;});
__d("ComposerXTokenizer",["CSS","CurrentUser","DOM","DOMQuery","Token","Tokenizer"],function(a,b,c,d,e,f){var g=b('CSS'),h=b('CurrentUser'),i=b('DOM'),j=b('DOMQuery'),k=b('Token'),l=b('Tokenizer');for(var m in l)if(l.hasOwnProperty(m))o[m]=l[m];var n=l===null?null:l.prototype;o.prototype=Object.create(n);o.prototype.constructor=o;o.__superConstructor__=l;function o(p,q){"use strict";l.call(this,p,q);this._loadingIndicatorText='';}o.prototype.createDecorativeToken=function(p,q){"use strict";var r=new k(p,this.paramName),s=r.createElement(false,q);r.setElement(s);if(h.getID()==p.uid)j.scry(s,'input[type="hidden"]').forEach(i.remove);return r;};o.prototype.setLoadingIndicatorText=function(p){"use strict";this._loadingIndicatorText=p;};o.prototype.addLoadingIndicator=function(){"use strict";if(this._loadingIndicator)return;this._loadingIndicator=this.createDecorativeToken({text:this._loadingIndicatorText},'loadingIndicator');i.appendContent(this.tokenarea,this._loadingIndicator.element);this.updateTokenarea();};o.prototype.removeToken=function(p){"use strict";if(p===this._loadingIndicator){this.removeLoadingIndicator();this.inform('removeLoadingIndicator');}else n.removeToken.call(this,p);};o.prototype.removeLoadingIndicator=function(){"use strict";if(!this._loadingIndicator)return;i.remove(this._loadingIndicator.element);this._loadingIndicator=null;this.updateTokenarea();};o.prototype.updateTokenareaVisibility=function(){"use strict";g.conditionShow(this.tokenarea,this.tokens.length!==0||this._loadingIndicator);};o.prototype.findToken=function(p){"use strict";var q=this._tokenKey(p);if(q in this.unique)return this.unique[q];return null;};o.prototype.replaceToken=function(p){"use strict";var q=this.findToken(p.getInfo());if(q){var r=q.getElement();q.setElement(p.getElement());i.replace(r,p.getElement());return true;}else{this.addToken(p);return false;}};e.exports=o;});
__d("ComposerXPrivacyWidgetTags",["Arbiter","CurrentUser","copyProperties","getObjectValues"],function(a,b,c,d,e,f){var g=b('Arbiter'),h=b('CurrentUser'),i=b('copyProperties'),j=b('getObjectValues');function k(l){"use strict";this._privacyWidget=l.getComponent('mainprivacywidget').element;this._mentionsInput=l.getComponent('maininput').instance;this._placeTypeahead=l.getComponent('placetagger').instance;this._friendsTokenizer=l.getComponent('withtagger')?l.getComponent('withtagger').instance:null;this._init();}k.prototype._init=function(){"use strict";this._subscriptions=[this._mentionsInput.subscribe('update',this._informChangedTags.bind(this)),this._placeTypeahead.subscribe('select',this._onPlaceSelect.bind(this)),g.subscribe('Events/autoSuggestionSelected',this._onPlaceSelect.bind(this)),this._placeTypeahead.subscribe('unselect',this._onPlaceUnselect.bind(this))];if(this._friendsTokenizer)this._subscriptions.push(this._friendsTokenizer.subscribe(['addToken','removeToken'],this._informChangedTags.bind(this)));};k.prototype._getTaggedNamesForAudience=function(){"use strict";var l={},m=this._mentionsInput.getMentions();for(var n in m)if(m[n].type=='user')l[n]=m[n].text;if(this._friendsTokenizer)this._friendsTokenizer.getTokens().map(function(o){l[o.getValue()]=o.getText();});delete l[h.getID()];return j(l);};k.prototype._onPlaceSelect=function(l,m){"use strict";this._placeType=m.selected.place_type;this._informChangedTags();};k.prototype._onPlaceUnselect=function(l,m){"use strict";this._placeType=null;this._informChangedTags();};k.prototype._informChangedTags=function(){"use strict";var l=[];if(this._friendsTokenizer)l=this._friendsTokenizer.getTokens();var m=null;if(this._placeType==='Event')m=this._placeTypeahead.getCore().getHiddenValue();g.inform('Composer/changedtags',{withTags:l,mention:this._mentionsInput.getMentions(),eventTag:m});};k.prototype.destroy=function(){"use strict";while(this._subscriptions.length)this._subscriptions.pop().unsubscribe();};i(k.prototype,{_subscriptions:null,_placeType:null});e.exports=k;});
__d("ComposerXStatusAttachment",["Arbiter","ComposerXAttachment","ComposerXAttachmentUtils","ComposerXController","ComposerXDragDrop","ComposerXPrivacyWidgetTags","DOM","Event","OGComposerJSConstants","Parent","URI","URLScraper","copyProperties","csx","cx"],function(a,b,c,d,e,f){var g=b('Arbiter'),h=b('ComposerXAttachment'),i=b('ComposerXAttachmentUtils'),j=b('ComposerXController'),k=b('ComposerXDragDrop'),l=b('ComposerXPrivacyWidgetTags'),m=b('DOM'),n=b('Event'),o=b('OGComposerJSConstants'),p=b('Parent'),q=b('URI'),r=b('URLScraper'),s=b('copyProperties'),t=b('csx'),u=b('cx');for(var v in h)if(h.hasOwnProperty(v))x[v]=h[v];var w=h===null?null:h.prototype;x.prototype=Object.create(w);x.prototype.constructor=x;x.__superConstructor__=h;function x(y,z,aa){"use strict";h.call(this);this._root=y;this._tagger=z;this._config=aa;}x.prototype.getRoot=function(){"use strict";return this._root;};x.prototype.initWithComponents=function(){"use strict";var y=this.getComponent('maininput');i.initMentions(y,this._config.mentionsPlaceholder);this._tagger.init(this);this._privacyWidgetTags=new l(this);var z=m.find(y.element,'textarea.input');if(!this._scraper){this._scraper=new r(z);this._scraper.subscribe('match',function(ba,ca){var da=new q(this._config.scraper_endpoint);da.addQueryData({scrape_url:encodeURIComponent(ca.url)});j.getAttachment(this._root,da.toString());}.bind(this));}this._scraper.enable();this._scraper.check();if(this._config.plus_version){this._dragdrop=new k(this._root,this._composerID,this._config.targetID);this._dragdrop.enableURLDropping();}var aa=m.scry(this._root,"._9s");if(aa.length>0)this._removeListener=n.listen(aa[0],'click',function(){var ba=m.find(this._root,'input[name="hide_object_attachment"]');ba.value=1;j.getAttachment(this._root,o.AttachmentURI);}.bind(this));g.inform('ComposerXStatusAttachment/ready');};x.prototype.cleanup=function(){"use strict";this._tagger.cleanup();this._privacyWidgetTags.destroy();this._privacyWidgetTags=null;this._scraper.disable();if(this._removeListener){this._removeListener.remove();this._removeListener=null;}if(this._dragdrop){this._dragdrop.deactivate();this._dragdrop=null;}};x.prototype.reset=function(){"use strict";this._tagger.reset();};x.prototype.canSwitchAway=function(){"use strict";return !p.byClass(this._root,'async_saving');};x.prototype.allowOGTagPreview=function(){"use strict";return true;};s(x.prototype,{_privacyWidgetTags:null,_scraper:null,_dragdrop:null,_removeListener:null,attachmentClassName:"_4j"});e.exports=x;});
__d("ComposerXImplicitLocation",[],function(a,b,c,d,e,f){function g(h,i,j,k){"use strict";this._citySharer=h;this._placeTagger=i;this._hiddenInput=j;this._subscriptions=[];this._subscribeChangeCity();this._subscribeSelect();this._subscribeUnselect();}g.prototype.cleanup=function(){"use strict";while(this._subscriptions.length)this._subscriptions.pop().unsubscribe();};g.prototype.disable=function(){"use strict";if(!this._placeTagger.getCore().getValue()){this._disableImplicit=true;this._citySharer.saveCityInfo();this._citySharer.clearCity();}this._placeTagger.getData().setBootstrapEndpoint('/ajax/places/typeahead/recent_tag.php');};g.prototype.enable=function(){"use strict";if(!this._placeTagger.getCore().getValue()){this._citySharer.restoreCityInfo();this._disableImplicit=false;}this._placeTagger.getData().resetBootstrapEndpoint();};g.prototype.selectPlace=function(h){"use strict";if(h.place_type=='city'){this._citySharer.changeCity(h.text,h.uid,h.city_id);this._placeTagger.getCore().setCity(h.city_id,true);}if(h.city_id){if(!this._disableImplicit){this._citySharer.changeCity(h.city_name,h.city_page_id,h.city_id);}else this._citySharer.setCityData(h.city_name,h.city_page_id,h.city_id);}else this._citySharer.clearCity();this._citySharer.addPlace(h);};g.prototype.unselectPlace=function(){"use strict";this._hiddenInput.value=this._citySharer.getValue();this._citySharer.clearPlace();if(this._disableImplicit)this.disable();};g.prototype._subscribeChangeCity=function(){"use strict";this._subscriptions.push(this._citySharer.subscribe('change',function(h,i){if(!this._placeTagger.getCore().getHiddenValue())this._hiddenInput.value=this._citySharer.getValue();if(i&&i.city_id)this._placeTagger.getCore().setCity(i.city_id,true);}.bind(this)));};g.prototype._subscribeSelect=function(){"use strict";this._subscriptions.push(this._placeTagger.subscribe('select',function(h,i){this.selectPlace(i.selected);}.bind(this)));};g.prototype._subscribeUnselect=function(){"use strict";this._subscriptions.push(this._placeTagger.subscribe('unselect',this.unselectPlace.bind(this)));};e.exports=g;});
__d("ComposerXNUX",["AsyncRequest","ComposerXDragDrop","CSS","DOM","Event","SubscriptionsHandler","csx","cx"],function(a,b,c,d,e,f){var g=b('AsyncRequest'),h=b('ComposerXDragDrop'),i=b('CSS'),j=b('DOM'),k=b('Event'),l=b('SubscriptionsHandler'),m=b('csx'),n=b('cx'),o={},p=new l();function q(s,t,u){var v=u.dataTransfer.items;if(v){var w=h.filterImages(v);if(!w.length)return;}r.acknowledgeDialog(s,t);}var r={CAMERA_NUX:'camera_nux_seen',ADD_MORE_NUX:'add_more_nux_seen',OGCOMPOSER_NUX:'ogcomposer_nux_seen',HMU_NUX:'hmu_nux_seen',HMU_POST_NUX:'hmu_post_nux_seen',FACEREC_SUGGESTIONS_NUX:'facerec_suggestions_nux_seen',TAGGING_FLYOUT_NUX:'tagging_flyout_nux_seen',onInit:function(s,t,u){if(o[u])return;p.engage();var v=s.getRoot();i.addClass(v,"_4bka");var w=j.scry(v,"._3o-a");w.forEach(function(x){p.addSubscriptions(k.listen(x,'click',r.acknowledgeDialog.bind(null,u,s)));});if(u==r.CAMERA_NUX)p.addSubscriptions(k.listen(document,'dragenter',q.bind(null,u,s)));p.addSubscriptions(s.subscribe('cancel',r.sendMarkSeenRequest.bind(null,u)),s.subscribe('hide',p.release.bind(p)));s.setContext(t).show();},acknowledgeDialog:function(s,t){r.sendMarkSeenRequest(s);t.hide();},sendMarkSeenRequest:function(s){if(!o[s]){new g('/ajax/photos/composer/mark_nux_seen.php').setData({type:s}).send();o[s]=true;}},onCleanup:function(s){s.hide();}};e.exports=r;});
__d("ComposerXCameraIconBehavior",["ComposerXMediaUploadHandler","ComposerXNUX","CSS","Event","cx"],function(a,b,c,d,e,f){var g=b('ComposerXMediaUploadHandler'),h=b('ComposerXNUX'),i=b('CSS'),j=b('Event'),k=b('cx'),l={initCameraIcon:function(m){this._cameraIcon=m.getComponent('cameraicon');if(!this._config.showCameraIcon){i.hide(this._cameraIcon.element);return;}i.show(this._cameraIcon.element);var n=this._cameraIcon.instance,o=new g(this._config.composerID);this._listeners.push(j.listen(this._cameraIcon.element,'click',function(){o.fetchAttachments();}.bind(this)));this._subscriptions.push(n.subscribe('change',function(){o.handleFileSelected(n);i.addClass(this._cameraIcon.element,"_19_a");}.bind(this)));if(this._config.plusNUXDialog){h.onInit(this._config.plusNUXDialog,this._cameraIcon.element,h.CAMERA_NUX);this._onCleanup.push(function(){h.onCleanup(this._config.plusNUXDialog);}.bind(this));}}};e.exports=l;});
__d("ComposerXStandardTagger",["Arbiter","ArbiterMixin","AsyncRequest","ComposerXImplicitLocation","CSS","CurrentUser","DOM","Event","Focus","Input","Keys","StickyPlaceholderInput","WeakToken","copyProperties","cx","isEmpty","mixin"],function(a,b,c,d,e,f){var g=b('Arbiter'),h=b('ArbiterMixin'),i=b('AsyncRequest'),j=b('ComposerXImplicitLocation'),k=b('CSS'),l=b('CurrentUser'),m=b('DOM'),n=b('Event'),o=b('Focus'),p=b('Input'),q=b('Keys'),r=b('StickyPlaceholderInput'),s=b('WeakToken'),t=b('copyProperties'),u=b('cx'),v=b('isEmpty'),w=b('mixin'),x=w(h);for(var y in x)if(x.hasOwnProperty(y))aa[y]=x[y];var z=x===null?null:x.prototype;aa.prototype=Object.create(z);aa.prototype.constructor=aa;aa.__superConstructor__=x;function aa(ba){"use strict";this._listeners=[];this._subscriptions=[];this._onCleanup=[];this._config=ba||{};this._taggers={};this._taggerIcons={};this._onTaggerShowCallbacks={};this._onTaggerHideCallbacks={};this._withTokens={};this._currentTagger=null;this._socialTextSelectors={};}aa.prototype.init=function(ba){"use strict";this._mentionsInput=ba.getComponent('maininput');this._withTagger=ba.getComponent('withtagger');this._withTaggerIcon=ba.getComponent('withtaggericon');this._placeTagger=ba.getComponent('placetagger');this._hiddenExplicitPlace=ba.getComponent('explicitplaceinput');this._citySharerIcon=ba.getComponent('citysharericon');this._hiddenPlaceInput=ba.getComponent('hiddenplaceinput');this._placeNameInput=ba.getComponent('placenameinput');this._sessionID=ba.getComponent('hiddensessionid');if(this._hasMentionsInput())this._input=m.scry(this._mentionsInput.element,'textarea.input')[0];this.initAndRegisterWithTagger();this.initAndRegisterPlaceTagger();this.registerAutoEventSuggestion();if(this._hasMentionsInput())this._listeners.push(n.listen(this._mentionsInput.element,'mousedown',this._onMentionsInputClicked.bind(this)));};aa.prototype.registerAutoEventSuggestion=function(){"use strict";this._subscriptions.push(g.subscribe('Events/autoSuggestionConfirmed',function(ba,ca){this._toggleTagger('place');g.inform("Events/autoSuggestionSelected",ca);o.set(this._input);}.bind(this)));};aa.prototype.initAndRegisterPlaceTagger=function(){"use strict";this.registerTagger('place',this._placeTagger,this._citySharerIcon);this.initTaggerInput('place',this._placeTagger.instance.getCore().getElement());this._initCitySharer();this._initPlaceTagger();};aa.prototype.initAndRegisterWithTagger=function(){"use strict";this.registerTagger('with',this._withTagger,this._withTaggerIcon);this.initTaggerInput('with',this._withTagger.instance.getInput());this._initWithTagger();};aa.prototype.cleanup=function(){"use strict";this._hideTaggers();this._listeners.forEach(function(ba){ba.remove();});this._listeners=[];this._subscriptions.forEach(function(ba){ba.unsubscribe();});this._subscriptions=[];this._onCleanup.forEach(function(ba){ba();});this._onCleanup=[];if(this._citySharerIcon)this._implicitLocation.cleanup();};aa.prototype.reset=function(){"use strict";if(this._socialTextRequest)this._socialTextRequest.abort();};aa.prototype.registerTagger=function(ba,ca,da){"use strict";this._taggers[ba]=ca;this._taggerIcons[ba]=da;this._listeners.push(n.listen(this._taggerIcons[ba].element,'click',this._toggleTagger.bind(this,ba)));};aa.prototype.initTaggerInput=function(ba,ca){"use strict";var da=this._config.placeholders||{};if(da[ba])r.setPlaceholderText(ca,da[ba]);this._onTaggerShowCallbacks[ba]=o.set.bind(null,ca);this._listeners.push(n.listen(ca,'keydown',function(ea){if(n.getKeyCode(ea)==q.RETURN&&!p.getValue(ea.getTarget())){this._hideTaggers();setTimeout(o.set.bind(null,this._input),0);}}.bind(this)));};aa.prototype.setTaggerCallback=function(ba,ca){"use strict";this._onTaggerShowCallbacks[ba]=ca;};aa.prototype.setTaggerHideCallback=function(ba,ca){"use strict";this._onTaggerHideCallbacks[ba]=ca;};aa.prototype.setWithTaggerDataSource=function(ba){"use strict";this._withTagger.instance.getTypeahead().swapData(ba);this._withTagger.instance.reset();this._updateWithTaggerUI();};aa.prototype._initCitySharer=function(){"use strict";this._implicitLocation=new j(this._citySharerIcon.instance,this._placeTagger.instance,this._hiddenPlaceInput.element);if(this._config.disableImplicitCity){this._implicitLocation.disable();}else this._implicitLocation.enable();};aa.prototype._onMentionsInputClicked=function(){"use strict";this._hideTaggers();};aa.prototype._initWithTagger=function(){"use strict";this._subscriptions.push(this._withTagger.instance.subscribe(['addToken','removeToken'],function(ba,ca){if(ba==='addToken'){this._withTokens[ca.info.uid]=ca;}else if(ba==='removeToken')delete this._withTokens[ca.info.uid];this._updateWithTaggerUI();}.bind(this)));this.addSocialTextSelector('with','span.withToken');this.refreshWithTaggerPlaceholder();};aa.prototype.getWithTaggerPlaceholder=function(){"use strict";return this._config.placeholders?this._config.placeholders['with']:null;};aa.prototype.refreshWithTaggerPlaceholder=function(){"use strict";var ba=this.getWithTaggerPlaceholder();if(ba)this._withTagger.instance.setPlaceholder(ba);};aa.prototype._initPlaceTagger=function(){"use strict";this._subscriptions.push(this._placeTagger.instance.subscribe('select',function(ba,ca){this._hiddenPlaceInput.element.value=ca.selected.uid;this._placeNameInput.element.value=ca.selected.text;this._hiddenExplicitPlace.element.value=true;this._placeType=ca.selected.place_type;this._updateTaggedText();this._hideTaggers();o.set(this._input);}.bind(this)));this._subscriptions.push(this._placeTagger.instance.subscribe('unselect',function(ba,ca){this._hiddenExplicitPlace.element.value=false;this._placeNameInput.element.value='';this._placeType=null;this._updateTaggedText();}.bind(this)));this.addSocialTextSelector('place','a.placeToken');};aa.prototype.addSocialTextSelector=function(ba,ca){"use strict";this._socialTextSelectors[ba]=ca;};aa.prototype.addSubscription=function(ba){"use strict";this._subscriptions.push(ba);};aa.prototype._showTagger=function(ba){"use strict";this._currentTagger=ba;k.show(this._taggers[ba].element);k.addClass(this._taggerIcons[ba].element,"_509o");if(ba==='with')new i().setURI('/ajax/fof/user_education.php').setData({increment:1}).send();if(this._onTaggerShowCallbacks[ba])this._onTaggerShowCallbacks[ba]();};aa.prototype._hideTagger=function(ba){"use strict";k.hide(this._taggers[ba].element);k.removeClass(this._taggerIcons[ba].element,"_509o");if(this._onTaggerHideCallbacks[ba])this._onTaggerHideCallbacks[ba]();if(this._currentTagger===ba)this._currentTagger=null;};aa.prototype._hideTaggers=function(){"use strict";for(var ba in this._taggers)this._hideTagger(ba);this._currentTagger=null;this.inform('hidetaggers');};aa.prototype.isAnyTaggerShown=function(){"use strict";return !!this._currentTagger;};aa.prototype.switchToTagger=function(ba){"use strict";this._hideTaggers();this._showTagger(ba);};aa.prototype._toggleTagger=function(ba){"use strict";if(k.shown(this._taggers[ba].element)){this._hideTaggers();}else this.switchToTagger(ba);};aa.prototype._getTaggedTextData=function(){"use strict";if(this._hasPlaceTagger())var ba=this._placeTagger.instance.getCore(),ca=ba.getHiddenValue(),da=ca&&ba.getValue();var ea=((this._withTagger&&this._withTagger.instance.getTokens())||[]).filter(function(fa){return fa.info.uid!=l.getID();});if(!ea.length&&!da)return {};return {people:ea.map(function(fa){return fa.info.uid;}),weakReferences:ea.filter(function(fa,ga,ha){return (fa instanceof s);}).map(function(fa){return fa.info.uid;}),place:da,placeID:ca,isNonSpecificPlace:this._isNonSpecificPlace()};};aa.prototype._updateTaggedText=function(){"use strict";if(this._hasMentionsInput()){var ba=this._getTaggedTextData();if(this.getExtraTaggedTextData)ba=t(ba,this.getExtraTaggedTextData());++this._requestID;if(v(ba)){this._mentionsInput.instance.setAuxContent(null);g.inform('reflow');return;}ba.requestID=this._requestID;ba.sessionID=this._sessionID.element.value,this._socialTextRequest=new i();this._socialTextRequest.setURI('/ajax/metacomposer/social_text.php').setData(ba).setHandler(this._handleSocialText.bind(this)).send();}};aa.prototype._updateWithTaggerUI=function(){"use strict";setTimeout(r.update.bind(null,this._withTagger.instance.getInput()),0);if(this._hasWithTaggerIcon())k.conditionClass(this._withTaggerIcon.element,"_1dsa",this._withTagger.instance.getFirstToken());this._updateTaggedText();};aa.prototype._handleSocialText=function(ba){"use strict";if(ba.payload.requestID===this._requestID){var ca=this._mentionsInput.instance;ca.setAuxContent(ba.payload.rendered);this._input.setAttribute('aria-labelledby',m.getID(ca.getAuxContentRoot()));g.inform('reflow');for(var da in this._socialTextSelectors){var ea=this._socialTextSelectors[da],fa=m.scry(ca.getAuxContentRoot(),ea);for(var ga=0;ga<fa.length;ga++){this._listeners.push(n.listen(fa[ga],'click',this.switchToTagger.bind(this,da)));this._listeners.push(n.listen(fa[ga],'mousedown',n.kill));}}}};aa.prototype._isNonSpecificPlace=function(){"use strict";return this._placeType=='city'||this._placeType=='state_province'||this._placeType=='country';};aa.prototype._hasMentionsInput=function(){"use strict";return this._mentionsInput!==undefined;};aa.prototype._hasPlaceTagger=function(){"use strict";return this._placeTagger!==undefined;};aa.prototype._hasWithTaggerIcon=function(){"use strict";return this._withTaggerIcon!==undefined;};t(aa.prototype,{_placeType:null,_requestID:0,_socialTextRequest:null});e.exports=aa;});
__d("ComposerXPlusTagger",["ComposerXCameraIconBehavior","ComposerXStandardTagger","classWithMixins","mixin"],function(a,b,c,d,e,f){var g=b('ComposerXCameraIconBehavior'),h=b('ComposerXStandardTagger'),i=b('classWithMixins'),j=b('mixin'),k=i(h,j(g));for(var l in k)if(k.hasOwnProperty(l))n[l]=k[l];var m=k===null?null:k.prototype;n.prototype=Object.create(m);n.prototype.constructor=n;n.__superConstructor__=k;function n(o){"use strict";k.call(this,o);this._eventuallyTagger=null;}n.prototype.init=function(o){"use strict";m.init.call(this,o);if(o.getComponent('cameraicon'))this.initCameraIcon(o);};n.prototype._nonObstrusiveSwitchToTagger=function(o){"use strict";var p=this._onTaggerShowCallbacks[o];delete this._onTaggerShowCallbacks[o];this.switchToTagger(o);this._dontHideTaggerOnMentionsFocus=o;this._onTaggerShowCallbacks[o]=p;};n.prototype.eventuallySwitchToTagger=function(o){"use strict";if(!this.isAnyTaggerShown()){this._nonObstrusiveSwitchToTagger(o);}else if(this._currentTagger!==o)this._eventuallyTagger=o;};n.prototype.switchToTagger=function(o){"use strict";if(this._eventuallyTagger===o)this._eventuallyTagger=null;this._nonEventuallyHideTaggers();this._showTagger(o);};n.prototype._hideTaggers=function(){"use strict";m._hideTaggers.call(this);if(this._eventuallyTagger){this._nonObstrusiveSwitchToTagger(this._eventuallyTagger);this._eventuallyTagger=null;}};n.prototype._nonEventuallyHideTaggers=function(){"use strict";m._hideTaggers.call(this);};n.prototype._onMentionsInputClicked=function(){"use strict";if(this._currentTagger!=this._dontHideTaggerOnMentionsFocus){this.eventuallySwitchToTagger(this._dontHideTaggerOnMentionsFocus);m._onMentionsInputClicked.call(this);}};e.exports=n;});
__d("ComposerXOGTaggerBehavior",["Arbiter","ComposerXController","ComposerXNUX","CSS","DOM","DOMQuery","Event","OGComposerJSConstants","Run","SubscriptionsHandler","URI","csx","cx","tx"],function(a,b,c,d,e,f){var g=b('Arbiter'),h=b('ComposerXController'),i=b('ComposerXNUX'),j=b('CSS'),k=b('DOM'),l=b('DOMQuery'),m=b('Event'),n=b('OGComposerJSConstants'),o=b('Run'),p=b('SubscriptionsHandler'),q=b('URI'),r=b('csx'),s=b('cx'),t=b('tx'),u=null;o.onBeforeUnload(function(){if(u&&u.isSet())return "You haven't finished your post yet. Do you want to leave without finishing?";});var v={initOGTagger:function(w){this._attachmentRoot=w.getRoot();this._showPreview=w.allowOGTagPreview();this._ogTagger=w.getComponent('ogtagger');this._ogIcon=w.getComponent('ogtaggericon');this._ogCustomIconID=null;u=this._ogTagger.instance;this.registerTagger('ogtagger',this._ogTagger,this._ogIcon);this.setTaggerCallback('ogtagger',this._ogTagger.instance.showTagger.bind(this._ogTagger.instance));this.setTaggerHideCallback('ogtagger',this._ogTagger.instance.hideTagger.bind(this._ogTagger.instance));this.addSubscription(this._ogTagger.instance.subscribe('changed',this._handleOGActionChanged.bind(this)));this.addSubscription(this._placeTagger.instance.subscribe(['select','unselect'],this._handlePlaceChanged.bind(this)));this.addSocialTextSelector('ogtagger','span.og_composer_object');this.addSubscription(g.subscribe('composer/initializedAttachment',function(){if(this._ogTagger.instance.isSet())g.inform('composer/deactivateDragdrop');}.bind(this)));if(this._config.ogcomposerNUXDialog&&this._config.ogcomposerNUXSecondaryDialog)this._setupNUX(w);this.addSubscription(g.subscribe('composer/ogCustomIconSelected',function(y,z){this._ogCustomIconID=z;}.bind(this)));this.subscribe('hidetaggers',this.hideTypeaheadView.bind(this));if(this._config.hasOGSuggestions&&!this._ogTagger.instance.suggestIconFlashed()){var x=l.find(this._ogIcon.element,"._5t3m");this._ogTagger.instance.flashSuggestIcon(x);this._ogTagger.instance.getVerbTypeahead().getData().bootstrapData.show_suggestions=true;}},_handleOGActionChanged:function(){this._ogCustomIconID=null;this._updateTaggedText();j.conditionClass(this._ogIcon.element,"_4-jh",this._ogTagger.instance.isSet());if(this._ogTagger.instance.isSet()){this._ogIcon.element.setAttribute('aria-selected','true');this._ogIcon.element.removeAttribute('role');}else{this._ogIcon.element.setAttribute('aria-selected','false');this._ogIcon.element.setAttribute('role','button');}if(this._showPreview&&this._ogTagger.instance.isSet()){g.inform('composer/deactivateDragdrop');this._hideTagger('ogtagger');if(this._ogTagger.instance.getObjectID()){var w=k.find(this._attachmentRoot,'input[name="hide_object_attachment"]');w.value=0;var x=new q(n.AttachmentURI);x.addQueryData({objectid:this._ogTagger.instance.getObjectID()});h.getAttachment(this._attachmentRoot,x.toString());}}else{g.inform('composer/reactivateDragdrop');var y=k.scry(this._attachmentRoot,"div.fbComposerOGAttachmentPreview");if(y.length>0)h.getAttachment(this._attachmentRoot,n.AttachmentURI);}},_handlePlaceChanged:function(w,x){var y=x.selected?x.selected.uid:0;this._ogTagger.instance.setPlaceID(y);},cleanupOGTagger:function(){u=null;},_cleanUpNUX:function(){this._nuxSubscriptions.release();if(this._config.ogcomposerNUXDialog){this._config.ogcomposerNUXDialog.destroy();this._config.ogcomposerNUXDialog=null;}if(this._config.ogcomposerNUXSecondaryDialog){this._config.ogcomposerNUXSecondaryDialog.destroy();this._config.ogcomposerNUXSecondaryDialog=null;}},_setupNUX:function(w){this._nuxSubscriptions=new p();this._nuxSubscriptions.engage();this._onCleanup.push(this._cleanUpNUX.bind(this));this._setupFirstNUX();this._setupSecondNUX();var x=w.getComponent('citysharericon');if(x)this._nuxSubscriptions.addSubscriptions(m.listen(x.element,'click',this._cleanUpNUX.bind(this)));},_setupFirstNUX:function(){i.onInit(this._config.ogcomposerNUXDialog,this._ogIcon.element,i.OGCOMPOSER_NUX);this._nuxSubscriptions.addSubscriptions(this._config.ogcomposerNUXDialog.subscribe('cancel',this.switchToTagger.bind(this,'ogtagger')),m.listen(k.find(this._config.ogcomposerNUXDialog.getRoot(),"._3o-a"),'click',this._cleanUpNUX.bind(this)),m.listen(this._ogIcon.element,'click',function(){this._config.ogcomposerNUXDialog.hide();}.bind(this)));},_setupSecondNUX:function(){this._nuxReturnFocus=false;this._verbTypeahead=this._ogTagger.instance.getVerbTypeahead();this._verbRenderSubscription=this._verbTypeahead.subscribe('render',function(){this._verbRenderSubscription.unsubscribe();this._config.ogcomposerNUXDialog.hide();this._config.ogcomposerNUXSecondaryDialog.setContext(this._verbTypeahead.getElement()).show();}.bind(this));var w=k.find(this._config.ogcomposerNUXSecondaryDialog.getRoot(),"._3o-a");this._nuxSubscriptions.addSubscriptions(this._verbRenderSubscription,m.listen(w,'mousedown',function(){if(this._verbTypeahead.view.isVisible())this._nuxReturnFocus=true;}.bind(this)),this._verbTypeahead.subscribe('blur',function(){if(this._nuxReturnFocus){this._verbTypeahead.view.show();this._verbTypeahead.getCore().focus();this._nuxReturnFocus=false;}}.bind(this)),m.listen(w,'click',this._cleanUpNUX.bind(this)),this._verbTypeahead.subscribe('select',this._cleanUpNUX.bind(this)));},getExtraTaggedTextData:function(){if(!this._ogTagger.instance.isSet())return null;var w={actionID:this._ogTagger.instance.getActionTypeID(),objectID:this._ogTagger.instance.getObjectID(),objectStr:this._ogTagger.instance.getObjectStr(),objectQuery:this._ogTagger.instance.getObjectQuery()};if(this._ogCustomIconID)w.actionIconID=this._ogCustomIconID;return w;},hideTypeaheadView:function(){this._ogTagger.instance.getNounTypeahead().getView().hide();}};e.exports=v;});
__d("ComposerXPlusTaggerWithOG",["ComposerXOGTaggerBehavior","ComposerXPlusTagger","classWithMixins","mixin"],function(a,b,c,d,e,f){var g=b('ComposerXOGTaggerBehavior'),h=b('ComposerXPlusTagger'),i=b('classWithMixins'),j=b('mixin'),k=i(h,j(g));for(var l in k)if(k.hasOwnProperty(l))n[l]=k[l];var m=k===null?null:k.prototype;n.prototype=Object.create(m);n.prototype.constructor=n;n.__superConstructor__=k;function n(){"use strict";if(k!==null)k.apply(this,arguments);}n.prototype.init=function(o){"use strict";m.init.call(this,o);this.initOGTagger(o);};n.prototype.cleanup=function(){"use strict";m.cleanup.call(this);this.cleanupOGTagger();};e.exports=n;});
__d("RTLKeys",["CurrentLocale","Keys","copyProperties"],function(a,b,c,d,e,f){var g=b('CurrentLocale'),h=b('Keys'),i=b('copyProperties'),j=i({},h);if(g.isRTL()){j.LEFT=h.RIGHT;j.RIGHT=h.LEFT;}e.exports=j;});
__d("OGComposerTagger",["Animation","ArbiterMixin","AsyncRequest","BanzaiNectarSimple","CSS","DOM","Event","Input","RTLKeys","StickyPlaceholderInput","csx","cx","mixin","tidyEvent"],function(a,b,c,d,e,f){var g=b('Animation'),h=b('ArbiterMixin'),i=b('AsyncRequest'),j=b('BanzaiNectarSimple'),k=b('CSS'),l=b('DOM'),m=b('Event'),n=b('Input'),o=b('RTLKeys'),p=b('StickyPlaceholderInput'),q=b('csx'),r=b('cx'),s=b('mixin'),t=b('tidyEvent'),u=s(h);for(var v in u)if(u.hasOwnProperty(v))x[v]=u[v];var w=u===null?null:u.prototype;x.prototype=Object.create(w);x.prototype.constructor=x;x.__superConstructor__=u;function x(y,z,aa,ba,ca){"use strict";this._verbTypeahead=y;this._nounTypeahead=z;this._hiddenObjectStr=aa;this._suggestionMechanismInput=ba;this._objectQuery=null;this._verbSpan=null;this._suggestIconElement=null;this._suggestIconFlashed=false;this._surveyURI=ca;this._shown=false;this._surveyed=false;y.getCore().preventFocusChangeOnTab=true;z.getCore().keepFocused=false;var da=l.scry(z.getElement(),'.uiCloseButton')[0];if(!da)da=l.scry(z.getElement(),"._50zy")[0];var ea=z.getCore().getElement(),fa=y.getCore().getElement();t([m.listen(da,'click',function(){this._showVerbTypeahead();return false;}.bind(this)),y.subscribe('select',function(ga,ha){this._suggestionMechanismInput.value=ha.selected.suggestion_mechanism;if(ha.selected.type=='page'){z.getCore().setHiddenValue(ha.selected.uid);y.getCore().setHiddenValue(ha.selected.at_id);this.inform('changed');return;}var ia=z.getData();ia.dirty();ia.queryData.at_id=ha.selected.uid;ia.bootstrapData.at_id=ha.selected.uid;ia.bootstrap();z.getView().setContext(ha.selected);p.setPlaceholderText(ea,ha.selected.prompt);l.setContent(this._getVerbSpan(),ha.selected.prompt_text);this._showNounTypeahead();}.bind(this)),z.subscribe('select',function(ga,ha){this._suggestionMechanismInput.value='';if(ha.selected.uid){aa.value='';}else{z.getCore().setHiddenValue('');aa.value=ha.selected.text.trim();}this._objectQuery=ha.selected.query;this.inform('changed');}.bind(this)),z.subscribe('unselect',function(ga,ha){aa.value='';this.inform('changed');}.bind(this)),m.listen(fa,'keydown',function(event){if(m.getKeyCode(event)==o.SPACE||m.getKeyCode(event)==o.RIGHT){y.getView().select(false);event.kill();}if(m.getKeyCode(event)!=o.BACKSPACE&&m.getKeyCode(event)!=o.DELETE&&m.getKeyCode(event)!=o.SPACE&&y.getData().value!=="")j.log('og_composer_waterfall','verb_typeahead',{search_string:y.getData().value});}),m.listen(ea,'keydown',function(event){if((m.getKeyCode(event)==o.BACKSPACE||m.getKeyCode(event)==o.LEFT)&&n.isEmpty(this._getNounInput()))this._showVerbTypeahead();}.bind(this))]);}x.prototype.showTagger=function(){"use strict";this._nounTypeahead.getCore().setEnabled(true);if(this.isSet()&&!this._suggestionMechanismInput.value){this._showNounTypeahead();}else if(this.isSet()){this._verbTypeahead.getCore().reset();this._nounTypeahead.getCore().reset();this.inform('changed');this._showVerbTypeahead();}else this._showVerbTypeahead();if(this._suggestIconElement)k.hide(this._suggestIconElement);this._shown=true;};x.prototype.hideTagger=function(){"use strict";this._nounTypeahead.getCore().setEnabled(false);};x.prototype.isSet=function(){"use strict";return !!(this.getObjectID()||this.getObjectStr());};x.prototype.reset=function(){"use strict";this._maybeShowSurvey();this._nounTypeahead.getCore().reset();this._verbTypeahead.getCore().reset();this._hiddenObjectStr.value='';this._objectQuery=null;this.setPlaceID(0);this._shown=false;};x.prototype.keydown=function(event){"use strict";var y=m.getKeyCode(event);if(y==o.BACKSPACE&&n.isEmpty(this._getNounInput()))this._showVerbTypeahead();};x.prototype.getActionTypeID=function(){"use strict";return this._verbTypeahead.getCore().getHiddenValue();};x.prototype.getObjectID=function(){"use strict";return this._nounTypeahead.getCore().getHiddenValue();};x.prototype.setPlaceID=function(y){"use strict";var z=this._nounTypeahead.getData();if(y!=z.bootstrapData.place_id){z.bootstrapData.place_id=y;z.queryData.place_id=y;if(z.bootstrapData.at_id){z.dirty();z.bootstrap();}}};x.prototype.getObjectStr=function(){"use strict";return this._hiddenObjectStr.value;};x.prototype.getObjectQuery=function(){"use strict";return this._objectQuery;};x.prototype.getVerbTypeahead=function(){"use strict";return this._verbTypeahead;};x.prototype.getNounTypeahead=function(){"use strict";return this._nounTypeahead;};x.prototype._getVerbSpan=function(){"use strict";if(!this._verbSpan){this._verbSpan=l.create('span',{className:'verbText'});l.prependContent(this._nounTypeahead.getElement(),this._verbSpan);t(m.listen(this._verbSpan,'click',function(){this._showVerbTypeahead();return false;}.bind(this)));}return this._verbSpan;};x.prototype._getNounInput=function(){"use strict";return this._nounTypeahead.getCore().getElement();};x.prototype._showVerbTypeahead=function(){"use strict";k.show(this._verbTypeahead.getElement());k.hide(this._nounTypeahead.getElement());this._verbTypeahead.getCore().reset();this._nounTypeahead.getCore().reset();this._verbTypeahead.getCore().getElement().focus();};x.prototype._showNounTypeahead=function(){"use strict";k.hide(this._verbTypeahead.getElement());k.show(this._nounTypeahead.getElement());this._nounTypeahead.getCore().getElement().focus();};x.prototype._maybeShowSurvey=function(){"use strict";if(this._surveyURI&&this._shown&&!this.isSet()&&!this._surveyed){this._surveyed=true;var y=l.find(document,"div._119");k.addClass(y,"child_was_focused");window.setTimeout(function(){var z=new i(this._surveyURI);z.send();}.bind(this),250);}};x.prototype.flashSuggestIcon=function(y){"use strict";var z=.7,aa=1000;this._suggestIconFlashed=true;this._suggestIconElement=y;k.show(this._suggestIconElement);new g(this._suggestIconElement).from('opacity',z).to('opacity',0).duration(aa).checkpoint().from('opacity',0).to('opacity',z).duration(aa).checkpoint().from('opacity',z).to('opacity',0).duration(aa).checkpoint().from('opacity',0).to('opacity',z).duration(aa).go();};x.prototype.suggestIconFlashed=function(){"use strict";return this._suggestIconFlashed;};e.exports=x;});
__d("ComposerXOGTaggerReset",["CSS"],function(a,b,c,d,e,f){var g=b('CSS');function h(i){i.instance.reset();g.hide(i.element);}e.exports=h;});
__d("ComposerXPeopleTaggerReset",["CSS"],function(a,b,c,d,e,f){var g=b('CSS');function h(i){i.instance.reset();g.hide(i.element);}e.exports=h;});
__d("ComposerXPlaceTaggerReset",["CSS"],function(a,b,c,d,e,f){var g=b('CSS');function h(i){i.instance.getCore().reset();g.hide(i.element);}e.exports=h;});
__d("PlacesTypeaheadRendererUtil",[],function(a,b,c,d,e,f){var g=/[.,+*?$|#{}()\^\-\[\]\\\/!@%"~=<>_:;]/g;function h(k,l){return k.end>l.end||k.start<l.start;}function i(k,l){if(!k)return [];var m=[];k=k.replace(g,' ');var n=k.split(' ');for(var o=0;o<n.length;o++){if(!n[o])continue;var p=n[o];if(o<n.length-1)p=p+'[ ,]';var q=new RegExp(' '+p,'i'),r=q.exec((' '+l+' '));if(r){var s={start:r.index,end:r.index+n[o].length};if(m.every(h.bind(null,s)))m.push(s);}else return [];}m.sort(function(t,u){return t.start-u.start;});return m;}var j={match_positions:i};e.exports=j;});
__d("PlacesTypeaheadRenderer",["DOM","PlacesTypeaheadRendererUtil"],function(a,b,c,d,e,f){var g=b('DOM'),h=b('PlacesTypeaheadRendererUtil');function i(j,k){var l=[],m=j.photo;if(m)l.push(g.create('img',{alt:'',src:m}));if(j.text){var n=g.create('span',{className:'text'},""),o=j.text;if(j.address)o=o+" \u00b7 "+j.address;var p=[];if(j.value)p=h.match_positions(j.value,o);if(p.length>0){var q=0;for(var r=0;r<p.length;r++){var s=p[r].start,t=p[r].end;g.appendContent(n,o.substr(q,(s-q)));g.appendContent(n,g.create('span',{className:'bold'},o.substr(s,t-s)));q=t;}g.appendContent(n,o.substr(q));}else{g.appendContent(n,g.create('span',{className:'bold'},j.text));if(j.address)g.appendContent(n," \u00b7 "+j.address);}l.push(g.create('span',{},n));}var u=j.subtext,v=j.category;if(u||v){var w=[];u&&w.push(u);v&&w.push(v);l.push(g.create('span',{className:'subtext'},w.join(' \u00b7 ')));}return g.create('li',{className:j.type||''},l);}i.className='places';e.exports=i;});
__d("OGComposerActionTypeTypeaheadRenderer",["CSS","DOM","CompactTypeaheadRenderer","cx"],function(a,b,c,d,e,f){var g=b('CSS'),h=b('DOM'),i=b('CompactTypeaheadRenderer'),j=b('cx');function k(l,m){var n=i(l,m);h.prependContent(n,l.icon);if(l.type=='action_type'){var o=h.create('i',{className:'arrowRight'});h.prependContent(n,o);}var p=h.scry(n,'span');if(p.length==1)g.addClass(p[0],"_5lpy");return n;}k.className="compact _47i9";e.exports=k;});
__d("OGComposerTypeaheadMetrics",["TypeaheadMetrics"],function(a,b,c,d,e,f){var g=b('TypeaheadMetrics');for(var h in g)if(g.hasOwnProperty(h))j[h]=g[h];var i=g===null?null:g.prototype;j.prototype=Object.create(i);j.prototype.constructor=j;j.__superConstructor__=g;function j(){"use strict";if(g!==null)g.apply(this,arguments);}j.prototype.submit=function(){"use strict";if(this.hasStats())this.stats.at_id=this.data.queryData.at_id;i.submit.call(this);};e.exports=j;});
__d("OGNounTypeaheadView",["CSS","DOM","HubsTypeaheadView","ScrollableArea","csx","cx","throttle","tidyEvent","tx"],function(a,b,c,d,e,f){var g=b('CSS'),h=b('DOM'),i=b('HubsTypeaheadView'),j=b('ScrollableArea'),k=b('csx'),l=b('cx'),m=b('throttle'),n=b('tidyEvent'),o=b('tx'),p;for(var q in i)if(i.hasOwnProperty(q))s[q]=i[q];var r=i===null?null:i.prototype;s.prototype=Object.create(r);s.prototype.constructor=s;s.__superConstructor__=i;function s(){"use strict";if(i!==null)i.apply(this,arguments);}s.prototype._bindScrollListener=function(){"use strict";this._getScrollableArea()&&n(p.subscribe('scroll',m(this._checkScroll.bind(this))));};s.prototype._checkScroll=function(){"use strict";var t=this._getLastItemID();if(p.isScrolledToBottom()&&this._lastItemID!==t){this._lastItemID=t;this.inform('scrolledtobottom',{scrollableArea:p});}};s.prototype._createFreeFormNode=function(t){"use strict";return {orig_text:t,icon:this.defaultIcon,text:t,type:'calltoaction'};};s.prototype._getScrollableArea=function(){"use strict";if(!this._scrollableArea)this._scrollableArea=j.getInstance(this.content);return p=this._scrollableArea;};s.prototype._getLastItemID=function(){"use strict";var t=this.items[this.items.length-1];return t&&t.getAttribute('aria-label');};s.prototype.init=function(){"use strict";this.content=h.find(this.element,"div._52yd");r.init.call(this);n([this.subscribe(['render','reset'],this._updateView.bind(this)),this.subscribe('highlight',this._scrollIntoView.bind(this)),this.subscribeOnce('render',this._bindScrollListener.bind(this))]);};s.prototype._scrollIntoView=function(t,u){"use strict";if(this._getScrollableArea()){this.ignoreMouseover=true;p.scrollIntoView(u.element,false);}};s.prototype.setContext=function(t){"use strict";this.defaultIcon=t.default_icon;};s.prototype._updateView=function(){"use strict";this._lastItemID=null;g.conditionClass(this.element,"_52yc",this.items.length);};s.prototype._createCustomAddNode=function(){"use strict";return {text:"Add your own...",type:'calltoaction customadd',icon:this.defaultIcon};};s.prototype.render=function(t,u,v){"use strict";if(u.length&&t==='')u.push(this._createCustomAddNode());return r.render.call(this,t,u,v);};s.prototype.select=function(t){"use strict";var u=this.results[this.index];if(u&&u.type.match('customadd')){this.causalElement.focus();this.layer.hide();return;}return r.select.call(this,t);};e.exports=s;});
__d("OGComposerObjectTypeaheadRenderer",["CompactTypeaheadRenderer","DOM"],function(a,b,c,d,e,f){var g=b('CompactTypeaheadRenderer'),h=b('DOM');function i(j,k){var l=g(j,k),m=j.icon;if(m)h.prependContent(l,m);return l;}i.className=g.className;e.exports=i;});