/*!CK:3691582584!*//*1387292953,178186557*/

if (self.CavalryLogger) { CavalryLogger.start_js(["N\/Fcp"]); }

__d("NumberDataSource",["DataSource"],function(a,b,c,d,e,f){var g=b('DataSource');for(var h in g)if(g.hasOwnProperty(h))j[h]=g[h];var i=g===null?null:g.prototype;j.prototype=Object.create(i);j.prototype.constructor=j;j.__superConstructor__=g;function j(k){"use strict";g.call(this,k);this.minNumber=k.minNumber;this.maxNumber=k.maxNumber;}j.prototype.init=function(){"use strict";i.init.call(this);var k=[];for(var l=this.minNumber;l<=this.maxNumber;l++)k.push({uid:l,text:l+'',type:'number'});this.addEntries(k);};e.exports=j;});
__d("PlacesDataSource",["DataSource"],function(a,b,c,d,e,f){var g=b('DataSource');for(var h in g)if(g.hasOwnProperty(h))j[h]=g[h];var i=g===null?null:g.prototype;j.prototype=Object.create(i);j.prototype.constructor=j;j.__superConstructor__=g;function j(k){"use strict";g.call(this,k);this._origBootstrapEndpoint=this.bootstrapEndpoint;}j.prototype.shouldFetchMoreResults=function(k){"use strict";if(this.queryData.new_js_ranking){return true;}else return i.shouldFetchMoreResults.call(this,k);};j.prototype.mergeUids=function(k,l,m,n){"use strict";if(this.queryData.new_js_ranking){this._checkExtendedMatch(n,k);return this.deduplicateByKey(m.concat(l,k));}else return i.mergeUids.call(this,k,l,m,n);};j.prototype.resetBootstrapEndpoint=function(k){"use strict";this.setBootstrapEndpoint(this._origBootstrapEndpoint,k);return this;};j.prototype.setBootstrapEndpoint=function(k,l){"use strict";if(this.bootstrapEndpoint!==k){this.bootstrapEndpoint=k;if(this._bootstrapped||this._bootstrapping)l=true;}if(l)this.dirty().bootstrap();return this;};j.prototype.getQueryEndpoint=function(){"use strict";return this.queryEndpoint;};j.prototype.getBootstrapData=function(){"use strict";return this.bootstrapData;};e.exports=j;});
__d("PlacesTypeaheadCore",["Arbiter","CSS","Focus","Run","StickyPlaceholderInput","Style","TypeaheadCore","UserAgent","copyProperties"],function(a,b,c,d,e,f){var g=b('Arbiter'),h=b('CSS'),i=b('Focus'),j=b('Run'),k=b('StickyPlaceholderInput'),l=b('Style'),m=b('TypeaheadCore'),n=b('UserAgent'),o=b('copyProperties');for(var p in m)if(m.hasOwnProperty(p))r[p]=m[p];var q=m===null?null:m.prototype;r.prototype=Object.create(q);r.prototype.constructor=r;r.__superConstructor__=m;function r(){"use strict";if(m!==null)m.apply(this,arguments);}r.prototype.init=function(s,t,u){"use strict";q.init.call(this,s,t,u);if(n.ie()<7)s.setMaxResults(5);this.arbiterTokens=[g.subscribe('Places/PlaceCreationCancel'+this.callbackID,function(v,w){this.view.allowPlaceCreation=false;this.view.allowFreeformOption=true;this.view.reset();this.focusElement();}.bind(this))];j.onLeave(function(){this.arbiterTokens.forEach(g.unsubscribe);}.bind(this));this._typeaheadID=u.id;this._citySet=false;this.data.subscribe('fetchComplete',this.update.bind(this));};r.prototype.initToggle=function(){"use strict";var s=this.root.parentNode,t=l.get(s,'position')!='static'?s:this.root,u=this.view,v='PlacesTypeaheadFocused';this.subscribe('focus',function(){u.show();h.addClass(t,v);});this.subscribe('blur',function(){u.hide();h.removeClass(t,v);});};r.prototype.focusElement=function(){"use strict";i.set(this.element);this.value='';this.checkValue();};r.prototype.setValue=function(s){"use strict";q.setValue.call(this,s);k.update(this.element);};r.prototype.updateDataSource=function(s){"use strict";this.data.setQueryData({city_id:this._cityId,city_set:this._citySet});this.data.setBootstrapData({city_id:this._cityId});if(s){this.data.dirty();this.data.bootstrap();}};r.prototype.setCity=function(s,t){"use strict";this._citySet=t;if(this._cityId!==s){this._cityId=s;this.updateDataSource(t);}};r.prototype.update=function(s,t){"use strict";var u=t.response;if(!u)return;var v=u.getPayload();if(v.cityId)if(!this._citySet)this.setCity(v.cityId,false);};o(r.prototype,{resetOnKeyup:false});e.exports=r;});
__d("PlacesTypeaheadBehavior",["CSS","DOM"],function(a,b,c,d,e,f){var g=b('CSS'),h=b('DOM'),i={init:function(j,k){j.subscribe(['reset','select','highlight'],function(l,m){if(l==='highlight'&&m.index!==-1&&m.selected.type!='freeform'&&m.selected.map&&!m.selected.changeCity){h.setContent(k,m.selected.map);g.show(k);}else g.hide(k);});}};e.exports=i;});
__d("NoTrucatingCompactTypeaheadRenderer",["CompactTypeaheadRenderer"],function(a,b,c,d,e,f){var g=b('CompactTypeaheadRenderer');function h(i,j){return g(i,j);}h.className='noTrucating compact';e.exports=h;});
__d("PlaceTypeaheadButton",["CSS"],function(a,b,c,d,e,f){var g=b('CSS'),h={toggleButton:function(i,j){g.addClass(i,'uiButtonDisabled');j.getView().subscribe('select',g.removeClass.bind(null,i,'uiButtonDisabled'));j.getView().subscribe('select',g.removeClass.bind(null,i,'hidden_elem'));j.getCore().subscribe('unselect',g.addClass.bind(null,i,'uiButtonDisabled'));}};e.exports=h;});
__d("legacy:place-typeahead-toggle-button",["PlaceTypeaheadButton"],function(a,b,c,d){a.PlaceTypeaheadButton=b('PlaceTypeaheadButton');},3);
__d("PlacesTypeaheadView",["Arbiter","AsyncRequest","CSS","Dialog","DOM","Parent","Run","ScrollableArea","TypeaheadView","copyProperties","tx"],function(a,b,c,d,e,f){var g=b('Arbiter'),h=b('AsyncRequest'),i=b('CSS'),j=b('Dialog'),k=b('DOM'),l=b('Parent'),m=b('Run'),n=b('ScrollableArea'),o=b('TypeaheadView'),p=b('copyProperties'),q=b('tx');for(var r in o)if(o.hasOwnProperty(r))t[r]=o[r];var s=o===null?null:o.prototype;t.prototype=Object.create(s);t.prototype.constructor=t;t.__superConstructor__=o;function t(){"use strict";if(o!==null)o.apply(this,arguments);}t.prototype.init=function(){"use strict";this.content=k.find(this.element,'div.PlacesTypeaheadViewList');s.init.call(this);this.subscribe(['render','reset'],this.renderBorders.bind(this));this.arbiterTokens=[g.subscribe('Places/PlaceCreated'+this.callbackID,function(u,v){var w={text:v.name,rawtext:v.name,uid:v.fbid,city_id:v.city_id,city_name:v.city_name,city_page_id:v.city_page_id};this.inform('select',{index:-1,clicked:true,selected:w});this.inform('afterSelect');}.bind(this))];if(this.allowHomeCreation)this.arbiterTokens.push(g.subscribe('Places/UpdateResidenceName'+this.callbackID,function(u,v){this.inform('select',{index:-1,clicked:true,selected:v.selected});this.inform('afterSelect');}.bind(this)));this.arbiterTokens.push(g.subscribe('Events/autoSuggestionSelected',function(u,v){this.inform('select',{index:-1,clicked:true,selected:{text:v.event_name,rawtext:v.event_name,uid:v.event_fbid}});this.inform('afterSelect');}.bind(this)));m.onLeave(function(){this.arbiterTokens.forEach(g.unsubscribe);}.bind(this));};t.prototype.renderBorders=function(){"use strict";i.conditionClass(this.element,'PlacesTypeaheadViewPopulated',this.items.length);};t.prototype.render=function(u,v,w){"use strict";v.forEach(function(aa){aa.value=u;});if(this.allowFreeformOption&&u&&(!v||v.length===0||v[v.length-1].type!='freeform')){var x=q._("Just use \"{custom_location}\"",{custom_location:u});v.push({uid:'0',rawtext:u,text:x,type:'freeform'});}if(this.allowPlaceCreation&&u&&(!v||v.length===0||v[v.length-1].type!='placecreate')){var y=q._("Add place \"{custom_location}\"",{custom_location:u});v.push({uid:'0',rawtext:u,text:y,type:'placecreate'});}s.render.call(this,u,v,w);var z=n.getInstance(this.content);z&&z.adjustGripper();};t.prototype.select=function(u){"use strict";var v=this.index,w=this.results[v];if(w){if(w.type==='placecreate'){j.bootstrap('/ajax/places/create/dialog.php',{name:w.rawtext,callback_id:this.callbackID});return;}if(w.type==='freeform')w.text=w.rawtext;if(w.place_type=='unconfirmed_residence'&&this.allowHomeCreation){w.text=w.value;new h().setURI('/ajax/places/create/residence_dialog.php').setData({selected:w,callbackid:this.callbackID,page_id:w.uid}).send();}s.select.call(this,u);}};t.prototype.next=function(){"use strict";s.next.call(this);this._scrollIntoView(this.selected);};t.prototype.prev=function(){"use strict";s.prev.call(this);this._scrollIntoView(this.selected);};t.prototype._scrollIntoView=function(u){"use strict";if(!l.byClass(u,'uiScrollableArea'))return;this.ignoreNextMouseover=true;var v=l.byClass(u,'uiScrollableAreaWrap'),w=u.offsetTop-v.offsetTop;if(w<v.scrollTop){v.scrollTop=w;return;}var x=w+u.offsetHeight;if(x>v.scrollTop+v.offsetHeight)v.scrollTop=x-v.offsetHeight;};t.prototype.mouseover=function(event){"use strict";this.ignoreNextMouseover||s.mouseover.call(this,event);this.ignoreNextMouseover=false;};t.prototype.highlight=function(u){"use strict";s.highlight.call(this,u,true);};p(t.prototype,{ignoreNextMouseover:false});e.exports=t;});
__d("SearchAdvancedFilters",["CSS","DOM","Event","Parent","SelectorDeprecated","$","copyProperties","createArrayFrom"],function(a,b,c,d,e,f){var g=b('CSS'),h=b('DOM'),i=b('Event'),j=b('Parent'),k=b('SelectorDeprecated'),l=b('$'),m=b('copyProperties'),n=b('createArrayFrom');function o(p,q,r){"use strict";this._selectors=p;this._fieldsets=q;this._submit_on_remove=r;}o.prototype.init=function(){"use strict";var p={},q=this._selectors,r=this._fieldsets,s;for(var t in q){var u=h.find(l(t),'.fbSearchAdvancedFiltersRemoveButton');p[t]={remove_button:u};s=q[t];k.getOptions(s).forEach(function(z){var aa=r[k.getOptionValue(z)];aa.options.push(z);if(k.isOptionSelected(z))p[t].fieldset=aa;});k.listen(s,'change',this.onSelect.bind(this));k.setEnabled(s,true);}var v=j.byTag(s,'table'),w=h.find(v,'.fbSearchAdvancedFiltersAddButton'),x=this._visible_table=h.find(v,'tbody.fbSearchAdvancedFiltersVisible');this._hidden_table=h.find(v,'tbody.fbSearchAdvancedFiltersHidden');for(var y in r)r[y].id=y;n(x.childNodes).forEach(function(z){p[z.id].fieldset.disableOptions();});this._row_info=p;this._add_button_container=j.byTag(w,'tr');if(this._submit_on_remove)this._form=j.byTag(x,'form');i.listen(w,'click',this.addRow.bind(this));i.listen(x,'click',this.removeRow.bind(this));this.updateButtons();};o.prototype.updateButtons=function(){"use strict";var p=this._visible_table;g.conditionShow(this._row_info[p.firstChild.id].remove_button,p.childNodes.length>1);g.conditionShow(this._add_button_container,this._hidden_table.childNodes.length>0);};o.prototype.getRowInfo=function(p){"use strict";return this._row_info[j.byTag(p,'tr').id];};o.prototype.onSelect=function(p){"use strict";var q=p.selector,r=this.getRowInfo(q),s=r.fieldset,t=l(s.id),u=this._fieldsets[k.getValue(q)],v=l(u.id),w=this._selectors[j.byTag(v,'tr').id],x=t.parentNode;r.fieldset=u;this.getRowInfo(w).fieldset=s;k.setSelected(w,s.id,true);s._typeaheads.forEach(function(y){y.getCore().reset();});u.disableOptions();s.enableOptions();v.parentNode.appendChild(t);x.appendChild(v);};o.prototype.addRow=function(){"use strict";var p=this._hidden_table.lastChild;if(p){this._row_info[p.id].fieldset.disableOptions();this._visible_table.appendChild(p);this.updateButtons();}};o.prototype.removeRow=function(event){"use strict";var p=j.byClass(event.getTarget(),'fbSearchAdvancedFiltersRemoveButton');if(p&&this._visible_table.childNodes.length>1){var q=j.byTag(p,'tr');this._row_info[q.id].fieldset.resetAndEnable(this._form);this._hidden_table.appendChild(q);this.updateButtons();}};m(o.prototype,{_form:null});e.exports=o;});
__d("legacy:SearchAdvancedFilters-js",["SearchAdvancedFilters"],function(a,b,c,d){a.SearchAdvancedFilters=b('SearchAdvancedFilters');},3);
__d("SearchAdvancedFiltersFieldset",["DOM","Form","Input","SelectorDeprecated"],function(a,b,c,d,e,f){var g=b('DOM'),h=b('Form'),i=b('Input'),j=b('SelectorDeprecated');function k(l,m,n){"use strict";this._typeaheads=l;this._inputs=m;this._selects=n;this.options=[];if(this._typeaheads)this._typeaheads.forEach(function(o){g.scry(o.getElement(),'input').forEach(function(p){p.disabled=false;});});}k.prototype.resetAndEnable=function(l){"use strict";var m=!!l;this._typeaheads.forEach(function(n){var o=n.getCore();m=m&&!o.getValue();o.reset();});this._inputs.forEach(function(n){m=m&&i.isEmpty(n);i.reset(n);});this._selects.forEach(function(n){m=m&&!n.selectedIndex;n.selectedIndex=0;});this.options.forEach(function(n){j.setOptionEnabled(n,true);});if(l&&!m)if(l.getAttribute('rel')=='async'){h.bootstrap(l);}else l.submit();};k.prototype.enableOptions=function(){"use strict";this.options.forEach(function(l){j.setOptionEnabled(l,true);});};k.prototype.disableOptions=function(){"use strict";this.options.forEach(function(l){if(!j.isOptionSelected(l))j.setOptionEnabled(l,false);});};e.exports=k;});
__d("legacy:SearchAdvancedFiltersFieldset",["SearchAdvancedFiltersFieldset"],function(a,b,c,d){a.SearchAdvancedFiltersFieldset=b('SearchAdvancedFiltersFieldset');},3);
__d("TypeaheadDefaultToText",["Event","copyProperties"],function(a,b,c,d,e,f){var g=b('Event'),h=b('copyProperties');function i(j){"use strict";this._typeahead=j;}i.prototype.enable=function(){"use strict";var j=this._typeahead.getCore(),k=j.getElement().form;function l(){j.getHiddenValue()||j.setHiddenValue(j.getValue());}this._blurSubscription=j.subscribe('blur',l);if(k)this._submitListener=g.listen(k,'submit',l);};i.prototype.disable=function(){"use strict";this._typeahead.getCore().unsubscribe(this._blurSubscription);this._blurSubscription=null;if(this._submitListener){this._submitListener.remove();this._submitListener=null;}};h(i.prototype,{_blurSubscription:null,_submitListener:null});e.exports=i;});
__d("legacy:DefaultToTextTypeaheadBehavior",["TypeaheadDefaultToText"],function(a,b,c,d){var e=b('TypeaheadDefaultToText');if(!a.TypeaheadBehaviors)a.TypeaheadBehaviors={};a.TypeaheadBehaviors.defaultToText=function(f){f.enableBehavior(e);};},3);
__d("legacy:PreventSubmitOnEnterTypeaheadBehavior",["TypeaheadPreventSubmitOnEnter"],function(a,b,c,d){var e=b('TypeaheadPreventSubmitOnEnter');if(!a.TypeaheadBehaviors)a.TypeaheadBehaviors={};a.TypeaheadBehaviors.preventSubmitOnEnter=function(f){f.enableBehavior(e);};},3);
__d("legacy:ShowResultsOnFocusTypeaheadBehavior",["TypeaheadShowResultsOnFocus"],function(a,b,c,d){var e=b('TypeaheadShowResultsOnFocus');if(!a.TypeaheadBehaviors)a.TypeaheadBehaviors={};a.TypeaheadBehaviors.showResultsOnFocus=function(f){f.enableBehavior(e);};},3);
__d("TypeaheadSubmitOnChange",["Form","copyProperties"],function(a,b,c,d,e,f){var g=b('Form'),h=b('copyProperties');function i(j){"use strict";this._typeahead=j;}i.prototype.enable=function(){"use strict";var j=this._typeahead.getCore(),k=j.getValue(),l=j.getElement().form;function m(){if(k!=j.getValue()){k=j.getValue();if(l.getAttribute('rel')=='async'){g.bootstrap(l);}else l.submit();}}this._subscription=this._typeahead.subscribe(['blur','select'],m);};i.prototype.disable=function(){"use strict";this._typeahead.unsubscribe(this._subscription);this._subscription=null;};h(i.prototype,{_subscription:null});e.exports=i;});
__d("legacy:SubmitOnChangeTypeaheadBehavior",["TypeaheadSubmitOnChange"],function(a,b,c,d){var e=b('TypeaheadSubmitOnChange');if(!a.TypeaheadBehaviors)a.TypeaheadBehaviors={};a.TypeaheadBehaviors.submitOnChange=function(f){f.enableBehavior(e);};},3);